<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ cv.profile.name }} - CV</title>
    {% if cv.google_analytics_id %}
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ cv.google_analytics_id }}"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '{{ cv.google_analytics_id }}');
    </script>
    {% endif %}
    <link rel="icon" type="image/svg+xml" href="{{ favicon_uri }}">
    {% if cv.canonical_url %}
    <link rel="canonical" href="{{ cv.canonical_url }}" />
    {% endif %}
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // Apply theme before page renders to prevent flash
        (function() {
            const stored = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = stored || (prefersDark ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
    <style>
        {{ light_theme.to_css_variables(':root, [data-theme="light"]') | safe }}
        {{ dark_theme.to_css_variables('[data-theme="dark"]') | safe }}
        {% include 'styles.css' %}
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                    },
                    colors: {
                        glass: {
                            light: 'rgba(255, 255, 255, 0.1)',
                            medium: 'rgba(255, 255, 255, 0.15)',
                            dark: 'rgba(0, 0, 0, 0.2)',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body style="background-color: var(--bg-primary); color: var(--text-primary);" class="font-sans antialiased">
    <!-- Animated background -->
    <div class="fixed inset-0 -z-10 overflow-hidden">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
        <div class="noise-overlay"></div>
    </div>

    <!-- Navigation -->
    {% filter indent(width=4) %}
    {% include 'nav.html' %}
    {% endfilter %}

    {# Macro to render HTML embeds for a section #}
    {% macro render_embeds(section_key) %}
        {% for html_block in cv.html_embeds.get(section_key, []) %}
        {{ html_block|safe }}
        {% endfor %}
    {% endmacro %}

    <!-- Main content -->
    <main>
        {% filter indent(width=8) %}
        {% include 'profile.html' -%}
        {{ render_embeds('profile') }}
        {% include 'experience.html' -%}
        {{ render_embeds('experience') }}
        {% include 'skills.html' -%}
        {{ render_embeds('skills_and_technologies') }}
        {% include 'certifications.html' -%}
        {% include 'education.html' -%}
        {{ render_embeds('education') }}
        {% include 'languages.html' -%}
        {{ render_embeds('languages') }}
        {% include 'contact.html' -%}
        {{ render_embeds('contact') }}
        {% endfilter %}
    </main>

    <!-- Footer -->
    <footer class="py-8 text-center text-sm" style="color: var(--text-muted);">
        <div class="glass-card inline-block px-6 py-3">
            <p>Â© <span id="year"></span> {{ cv.profile.name }}.</p>
        </div>
    </footer>

    <script>
        {% include 'scripts.js' %}
    </script>
</body>
</html>
